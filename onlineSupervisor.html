<!DOCTYPE html>
<html>
    <head>
        <title>Online Mode: Start Game</title>
        <link rel = "stylesheet" href = "css/styling.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
        <script src="js/CSS.js"></script>
        <link rel = "icon" href = "projectFiles/icon.ico">
    </head>

    <body id = "index">
        <div id = "mySidenav" class="navbar">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <a href="index.html">Home</a>
            <button class="dropbtn">Online Mode
                <i class="fa fa-caret-down"></i>
            </button>

            <div class="dropdown-content">
                <a href="onlineCreate.html">Create</a>
                <a href="onlineJoin.html">Join</a>
            </div>
            <button class="dropbtn">Offline Mode
                <i class="fa fa-caret-down"></i>
            </button>

            <div class="dropdown-content">
                <a href="offlineEasy.html">Easy</a>
                <a href="offlineMedium.html">Medium</a>
                <a href="offlineHard.html">Difficult</a>
                <a href="offlineCustom.html">Custom</a>
            </div>
        </div>

        <script>
            var dropdown = document.getElementsByClassName("dropbtn");
            var i;

            for (i = 0; i < dropdown.length; i++) {
            dropdown[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var dropdownContent = this.nextElementSibling;
                if (dropdownContent.style.display === "block") {
                dropdownContent.style.display = "none";
                } else {
                dropdownContent.style.display = "block";
                }
            });
            }
        </script>

        <div id="main" class = "mainDiv">
            <div class = "container" onclick = "openNav()">
                <div class = 'line1'></div>
                <div class = 'line2'></div>
                <div class = 'line3'></div>
            </div>

        <table id = "scoreDisplay">
            <tr>
                <th>Name</th>
                <th>Score</th>
            </tr>
            <tr>
                <td></td>
                <td></td>
            </tr>
        </table><br>

        <script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-database.js"></script>

        <script>
            var firebaseConfig = {
                apiKey: "AIzaSyDpREM9IPNuoVLjX0Yv74IA5f9aUnysK-U",
                authDomain: "memoryapp-69da9.firebaseapp.com",
                databaseURL: "https://memoryapp-69da9.firebaseio.com",
                projectId: "memoryapp-69da9",
                storageBucket: "memoryapp-69da9.appspot.com",
                messagingSenderId: "315432298371",
                appId: "1:315432298371:web:df4285484600df6af438b6"
            };
            try {firebase.initializeApp(firebaseConfig);}
            catch {}
            var database = firebase.database();
            var ID = localStorage.getItem('clientID');

            database.ref('ClientNames/' + ID + '/value').once('value').then(function(snapshot2) {
                localStorage.setItem('finalNames', snapshot2.val());

            });

            database.ref('ClientScores/' + ID).on('value', function(snapshot2) {
                var names = JSON.parse(localStorage.getItem('finalNames'));
                var table = document.getElementById('scoreDisplay');

                for(var i = 0; i < names.length; i++) {
                    var row = table.insertRow(table.rows.length);
                    var cell0 = row.insertCell(0);
                    var cell1 = row.insertCell(1);
                    
                    cell0.innerHTML = names[i];
                    database.ref('ClientScores/' + ID + '/' + names[i]).once('value').then(function(snapshot) {
                        cell1.innerHTML = snapshot.val().value;
                    });
                }
            });
        </script>
        </div>
    </body>
</html>